package com.cloud_bridge.cluster;import com.cloud_bridge.api.PubAndSubClient;import com.cloud_bridge.client.NettyPubAndSubClient;import com.cloud_bridge.conf.ConfigFactory;import com.cloud_bridge.conf.PropertyConfigFactory;import com.cloud_bridge.conf.ServerConfig;import com.cloud_bridge.halder.ChannelHolder;import com.cloud_bridge.model.Message;import com.cloud_bridge.server.impl.TCPServer;import lombok.extern.slf4j.Slf4j;import java.util.Map;import java.util.concurrent.ExecutorService;import java.util.concurrent.Executors;@Slf4jpublic class ConnectServers {    PropertyConfigFactory configFac=new PropertyConfigFactory();    /**     * 创建线程池     */    private final ExecutorService executorService= Executors.newFixedThreadPool(1);    public  void connect() {        ServerConfig config = configFac.getConfig(ConfigFactory.filaPath);        // 首先获取所有的服务主机和端口号        ClusterConfig clusterConfig = new ClusterConfig(config);        Map<String, String> map = clusterConfig.getMap();        map.keySet().forEach(key ->{            NettyPubAndSubClient client = NettyPubAndSubClient.getInstance().connect(key,map.get(key));            // 连接成功后 发送认证信息            client.auth("wzw", "666", new PubAndSubClient.AutuListener() {                @Override                public void authOk(Message message) {                    log.info("成功"+message.toString());                }                @Override                public void authFail(Message message) {                    log.info("失败"+message.toString());                }            });            // 保存连接 便于后续消息广播            ChannelHolder.getChannel();        });    }}